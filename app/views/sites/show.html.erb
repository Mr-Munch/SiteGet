<h1><%= @site.name %></h1>

<div class="post-box clearfix">
	<% if @post_image.image_id? %>
		<%= attachment_image_tag @post_image, :image, :fill, 1024, 500, format: 'jpeg'%>
	<% else %>
		<div class="site-photo1">
			<%= render 'sites/site', site: @site  %>
		</div>
	<% end %>

	<h3>spot</h3>
	<div id="map"></div>

	<script>
	function initMap(latlng) {
	  var map = new google.maps.Map(document.getElementById('map'), {
	    center: latlng,
	    zoom: 16
	  });

	  var marker = new google.maps.Marker({
	    position: latlng,
	    map: map
	  });
	}

	function getLatLng() {
	  var geocoder = new google.maps.Geocoder();

	  geocoder.geocode({
	    address: "<%= @site.address %>"
	  }, function(results, status) {
	    if (status == google.maps.GeocoderStatus.OK) {
	      for (var i in results) {
	        if (results[i].geometry) {
	          var latlng = results[i].geometry.location;
	          initMap(latlng)
	        }
	      }
	    }
	  });
	}
	</script>

	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCU0j2ku0aK7diV25c4Bf6Y2kz3r1Mkw10&callback=getLatLng"
	async defer></script>

	<h3>post</h3>
	<%= form_for([@site, @post_image]) do |f| %>
		<div class="photo-post">
			<%= f.attachment_field :image %>
			<%= f.text_area :comment, placeholder: "撮影時の感想を書いてね！" %>
			<%= f.submit "投稿する", class: "btn btn-info btn-block" %>
		</div>
		<div class="camera-mark">
			<%= image_tag('image/カメラアイコン8.jpeg', style: "width: 300px; height: 300px;") %>
		</div>
	<% end %>

</div>